<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Αυτοματοποιημένη χαρτογράφηση της σεισμικής δραστηριότητας με βιβλιοθήκες ΕΛΛΑΚ. - Λεωνίδας Λιάκος - Γεωγράφος. Leonidas Liakos - Geographer</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html">

        <meta name="author" content="Leonidas Liakos" />
        <meta name="keywords" content="mapnik,ogr,python,σεισμοί" />
        <meta name="description" content="Αρκετοί χρήστες, κυρίως αρχάριοι, αναρωτιούνται γιατί να χρησιμοποιήσει κάποιος μια γλώσσα προγραμματισμού και να συντάξει ένα σενάριο (script), πολύπλοκων αρκετές φορές, εντολών για να παράγει ένα χάρτη από την στιγμή που υπάρχει λογισμικό με γραφικό περιβάλλον που με ευκολία μπορεί να οδηγήσει στο ίδιο αποτέλεσμα; Η απάντηση είναι, μεταξύ άλλων …" />

        <meta property="og:site_name" content="Λεωνίδας Λιάκος - Γεωγράφος. Leonidas Liakos - Geographer" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Αυτοματοποιημένη χαρτογράφηση της σεισμικής δραστηριότητας με βιβλιοθήκες ΕΛΛΑΚ."/>
        <meta property="og:url" content="https://geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html"/>
        <meta property="og:description" content="Αρκετοί χρήστες, κυρίως αρχάριοι, αναρωτιούνται γιατί να χρησιμοποιήσει κάποιος μια γλώσσα προγραμματισμού και να συντάξει ένα σενάριο (script), πολύπλοκων αρκετές φορές, εντολών για να παράγει ένα χάρτη από την στιγμή που υπάρχει λογισμικό με γραφικό περιβάλλον που με ευκολία μπορεί να οδηγήσει στο ίδιο αποτέλεσμα; Η απάντηση είναι, μεταξύ άλλων …"/>
        <meta property="article:published_time" content="2012-01-28" />
            <meta property="article:section" content="GIS" />
            <meta property="article:tag" content="mapnik" />
            <meta property="article:tag" content="ogr" />
            <meta property="article:tag" content="python" />
            <meta property="article:tag" content="σεισμοί" />
            <meta property="article:author" content="Leonidas Liakos" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://geographer.gr/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://geographer.gr/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://geographer.gr/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://geographer.gr/theme/css/style.css" type="text/css"/>

        <link href="https://geographer.gr/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Λεωνίδας Λιάκος - Γεωγράφος. Leonidas Liakos - Geographer ATOM Feed"/>

        <link href="https://geographer.gr/feeds/gis.atom.xml" type="application/atom+xml" rel="alternate"
              title="Λεωνίδας Λιάκος - Γεωγράφος. Leonidas Liakos - Geographer GIS ATOM Feed"/>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116514702-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', UA-116514702-1);
    </script>
    <!-- End Google Analytics Code -->
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','');</script>
    <!-- End Google Tag Manager -->

</head>
<body>

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://geographer.gr/" class="navbar-brand">
Λεωνίδας Λιάκος - Γεωγράφος. Leonidas Liakos - Geographer            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="https://geographer.gr/pages/about-me.html">
                             About me
                          </a></li>
                         <li><a href="https://geographer.gr/pages/contact-greek.html">
                             Επικοινωνία
                          </a></li>
                        <li >
                            <a href="https://geographer.gr/category/demosieuseis.html">Δημοσιεύσεις</a>
                        </li>
                        <li >
                            <a href="https://geographer.gr/category/diaphora.html">Διάφορα</a>
                        </li>
                        <li class="active">
                            <a href="https://geographer.gr/category/gis.html">Gis</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<style>
	#banner{
	    background-image:url("https://geographer.gr/../extra/header_left_bg.png");
	}
</style>

<div id="banner">
	<div class="container">
<!-- 		<div class="copy">
			<h1>Λεωνίδας Λιάκος - Γεωγράφος. Leonidas Liakos - Geographer</h1>
				<p class="intro">This is my subtitle</p>
		</div>
 -->	</div>
</div><!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="https://geographer.gr" title="Λεωνίδας Λιάκος - Γεωγράφος. Leonidas Liakos - Geographer"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="https://geographer.gr/category/gis.html" title="GIS">GIS</a></li>
                <li class="active">Αυτοματοποιημένη χαρτογράφηση της σεισμικής δραστηριότητας με βιβλιοθήκες ΕΛΛΑΚ.</li>
            </ol>


<section>
  <p id="post-share-links">
    <b>Share on:</b>
    <a href="https://sharetodiaspora.github.io/?title=%CE%91%CF%85%CF%84%CE%BF%CE%BC%CE%B1%CF%84%CE%BF%CF%80%CE%BF%CE%B9%CE%B7%CE%BC%CE%AD%CE%BD%CE%B7%20%CF%87%CE%B1%CF%81%CF%84%CE%BF%CE%B3%CF%81%CE%AC%CF%86%CE%B7%CF%83%CE%B7%20%CF%84%CE%B7%CF%82%20%CF%83%CE%B5%CE%B9%CF%83%CE%BC%CE%B9%CE%BA%CE%AE%CF%82%20%CE%B4%CF%81%CE%B1%CF%83%CF%84%CE%B7%CF%81%CE%B9%CF%8C%CF%84%CE%B7%CF%84%CE%B1%CF%82%20%CE%BC%CE%B5%20%CE%B2%CE%B9%CE%B2%CE%BB%CE%B9%CE%BF%CE%B8%CE%AE%CE%BA%CE%B5%CF%82%20%CE%95%CE%9B%CE%9B%CE%91%CE%9A.&url=https%3A//geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html" title="Share on Diaspora">Diaspora*</a>
    ❄
    <a href="https://twitter.com/intent/tweet?text=%CE%91%CF%85%CF%84%CE%BF%CE%BC%CE%B1%CF%84%CE%BF%CF%80%CE%BF%CE%B9%CE%B7%CE%BC%CE%AD%CE%BD%CE%B7%20%CF%87%CE%B1%CF%81%CF%84%CE%BF%CE%B3%CF%81%CE%AC%CF%86%CE%B7%CF%83%CE%B7%20%CF%84%CE%B7%CF%82%20%CF%83%CE%B5%CE%B9%CF%83%CE%BC%CE%B9%CE%BA%CE%AE%CF%82%20%CE%B4%CF%81%CE%B1%CF%83%CF%84%CE%B7%CF%81%CE%B9%CF%8C%CF%84%CE%B7%CF%84%CE%B1%CF%82%20%CE%BC%CE%B5%20%CE%B2%CE%B9%CE%B2%CE%BB%CE%B9%CE%BF%CE%B8%CE%AE%CE%BA%CE%B5%CF%82%20%CE%95%CE%9B%CE%9B%CE%91%CE%9A.&url=https%3A//geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html&hashtags=mapnik,ogr,python,seismoi" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html" title="Share on Facebook">Facebook</a>
    ❄
    <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A//geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html&title=%CE%91%CF%85%CF%84%CE%BF%CE%BC%CE%B1%CF%84%CE%BF%CF%80%CE%BF%CE%B9%CE%B7%CE%BC%CE%AD%CE%BD%CE%B7%20%CF%87%CE%B1%CF%81%CF%84%CE%BF%CE%B3%CF%81%CE%AC%CF%86%CE%B7%CF%83%CE%B7%20%CF%84%CE%B7%CF%82%20%CF%83%CE%B5%CE%B9%CF%83%CE%BC%CE%B9%CE%BA%CE%AE%CF%82%20%CE%B4%CF%81%CE%B1%CF%83%CF%84%CE%B7%CF%81%CE%B9%CF%8C%CF%84%CE%B7%CF%84%CE%B1%CF%82%20%CE%BC%CE%B5%20%CE%B2%CE%B9%CE%B2%CE%BB%CE%B9%CE%BF%CE%B8%CE%AE%CE%BA%CE%B5%CF%82%20%CE%95%CE%9B%CE%9B%CE%91%CE%9A.&summary=%CE%91%CF%81%CE%BA%CE%B5%CF%84%CE%BF%CE%AF%20%CF%87%CF%81%CE%AE%CF%83%CF%84%CE%B5%CF%82%2C%20%CE%BA%CF%85%CF%81%CE%AF%CF%89%CF%82%20%CE%B1%CF%81%CF%87%CE%AC%CF%81%CE%B9%CE%BF%CE%B9%2C%20%CE%B1%CE%BD%CE%B1%CF%81%CF%89%CF%84%CE%B9%CE%BF%CF%8D%CE%BD%CF%84%CE%B1%CE%B9%20%CE%B3%CE%B9%CE%B1%CF%84%CE%AF%20%CE%BD%CE%B1%0A%CF%87%CF%81%CE%B7%CF%83%CE%B9%CE%BC%CE%BF%CF%80%CE%BF%CE%B9%CE%AE%CF%83%CE%B5%CE%B9%20%CE%BA%CE%AC%CF%80%CE%BF%CE%B9%CE%BF%CF%82%20%CE%BC%CE%B9%CE%B1%20%CE%B3%CE%BB%CF%8E%CF%83%CF%83%CE%B1%20%CF%80%CF%81%CE%BF%CE%B3%CF%81%CE%B1%CE%BC%CE%BC%CE%B1%CF%84%CE%B9%CF%83%CE%BC%CE%BF%CF%8D%20%CE%BA%CE%B1%CE%B9%20%CE%BD%CE%B1%20%CF%83%CF%85%CE%BD%CF%84%CE%AC%CE%BE%CE%B5%CE%B9%20%CE%AD%CE%BD%CE%B1%0A%CF%83%CE%B5%CE%BD%CE%AC%CF%81%CE%B9%CE%BF%20%28script%29%2C%20%CF%80%CE%BF%CE%BB%CF%8D%CF%80%CE%BB%CE%BF%CE%BA%CF%89%CE%BD%20%CE%B1%CF%81%CE%BA%CE%B5%CF%84%CE%AD%CF%82%20%CF%86%CE%BF%CF%81%CE%AD%CF%82%2C%20%CE%B5%CE%BD%CF%84%CE%BF%CE%BB%CF%8E%CE%BD%20%CE%B3%CE%B9%CE%B1%20%CE%BD%CE%B1%20%CF%80%CE%B1%CF%81%CE%AC%CE%B3%CE%B5%CE%B9%20%CE%AD%CE%BD%CE%B1%0A%CF%87%CE%AC%CF%81%CF%84%CE%B7%20%CE%B1%CF%80%CF%8C%20%CF%84%CE%B7%CE%BD%20%CF%83%CF%84%CE%B9%CE%B3%CE%BC%CE%AE%20%CF%80%CE%BF%CF%85%20%CF%85%CF%80%CE%AC%CF%81%CF%87%CE%B5%CE%B9%20%CE%BB%CE%BF%CE%B3%CE%B9%CF%83%CE%BC%CE%B9%CE%BA%CF%8C%20%CE%BC%CE%B5%20%CE%B3%CF%81%CE%B1%CF%86%CE%B9%CE%BA%CF%8C%20%CF%80%CE%B5%CF%81%CE%B9%CE%B2%CE%AC%CE%BB%CE%BB%CE%BF%CE%BD%20%CF%80%CE%BF%CF%85%20%CE%BC%CE%B5%0A%CE%B5%CF%85%CE%BA%CE%BF%CE%BB%CE%AF%CE%B1%20%CE%BC%CF%80%CE%BF%CF%81%CE%B5%CE%AF%20%CE%BD%CE%B1%20%CE%BF%CE%B4%CE%B7%CE%B3%CE%AE%CF%83%CE%B5%CE%B9%20%CF%83%CF%84%CE%BF%20%CE%AF%CE%B4%CE%B9%CE%BF%20%CE%B1%CF%80%CE%BF%CF%84%CE%AD%CE%BB%CE%B5%CF%83%CE%BC%CE%B1%3B%20%CE%97%20%CE%B1%CF%80%CE%AC%CE%BD%CF%84%CE%B7%CF%83%CE%B7%20%CE%B5%CE%AF%CE%BD%CE%B1%CE%B9%2C%20%CE%BC%CE%B5%CF%84%CE%B1%CE%BE%CF%8D%0A%CE%AC%CE%BB%CE%BB%CF%89%CE%BD%20%E2%80%A6&source=https%3A//geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html" title="Share on LinkedIn">LinkedIn</a>
    ❄
    <a href="https://news.ycombinator.com/submitlink?t=%CE%91%CF%85%CF%84%CE%BF%CE%BC%CE%B1%CF%84%CE%BF%CF%80%CE%BF%CE%B9%CE%B7%CE%BC%CE%AD%CE%BD%CE%B7%20%CF%87%CE%B1%CF%81%CF%84%CE%BF%CE%B3%CF%81%CE%AC%CF%86%CE%B7%CF%83%CE%B7%20%CF%84%CE%B7%CF%82%20%CF%83%CE%B5%CE%B9%CF%83%CE%BC%CE%B9%CE%BA%CE%AE%CF%82%20%CE%B4%CF%81%CE%B1%CF%83%CF%84%CE%B7%CF%81%CE%B9%CF%8C%CF%84%CE%B7%CF%84%CE%B1%CF%82%20%CE%BC%CE%B5%20%CE%B2%CE%B9%CE%B2%CE%BB%CE%B9%CE%BF%CE%B8%CE%AE%CE%BA%CE%B5%CF%82%20%CE%95%CE%9B%CE%9B%CE%91%CE%9A.&u=https%3A//geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html" title="Share on HackerNews">HackerNews</a>
    ❄
    <a href="mailto:?subject=%CE%91%CF%85%CF%84%CE%BF%CE%BC%CE%B1%CF%84%CE%BF%CF%80%CE%BF%CE%B9%CE%B7%CE%BC%CE%AD%CE%BD%CE%B7%20%CF%87%CE%B1%CF%81%CF%84%CE%BF%CE%B3%CF%81%CE%AC%CF%86%CE%B7%CF%83%CE%B7%20%CF%84%CE%B7%CF%82%20%CF%83%CE%B5%CE%B9%CF%83%CE%BC%CE%B9%CE%BA%CE%AE%CF%82%20%CE%B4%CF%81%CE%B1%CF%83%CF%84%CE%B7%CF%81%CE%B9%CF%8C%CF%84%CE%B7%CF%84%CE%B1%CF%82%20%CE%BC%CE%B5%20%CE%B2%CE%B9%CE%B2%CE%BB%CE%B9%CE%BF%CE%B8%CE%AE%CE%BA%CE%B5%CF%82%20%CE%95%CE%9B%CE%9B%CE%91%CE%9A.&amp;body=https%3A//geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html" title="Share via Email">Email</a>
    ❄
    <a href="https://www.reddit.com/submit?url=https%3A//geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html&title=%CE%91%CF%85%CF%84%CE%BF%CE%BC%CE%B1%CF%84%CE%BF%CF%80%CE%BF%CE%B9%CE%B7%CE%BC%CE%AD%CE%BD%CE%B7%20%CF%87%CE%B1%CF%81%CF%84%CE%BF%CE%B3%CF%81%CE%AC%CF%86%CE%B7%CF%83%CE%B7%20%CF%84%CE%B7%CF%82%20%CF%83%CE%B5%CE%B9%CF%83%CE%BC%CE%B9%CE%BA%CE%AE%CF%82%20%CE%B4%CF%81%CE%B1%CF%83%CF%84%CE%B7%CF%81%CE%B9%CF%8C%CF%84%CE%B7%CF%84%CE%B1%CF%82%20%CE%BC%CE%B5%20%CE%B2%CE%B9%CE%B2%CE%BB%CE%B9%CE%BF%CE%B8%CE%AE%CE%BA%CE%B5%CF%82%20%CE%95%CE%9B%CE%9B%CE%91%CE%9A." title="Share via Reddit">Reddit</a>
  </p>
</section>

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html"
                       rel="bookmark"
                       title="Permalink to Αυτοματοποιημένη χαρτογράφηση της σεισμικής δραστηριότητας με βιβλιοθήκες ΕΛΛΑΚ.">
                        Αυτοματοποιημένη χαρτογράφηση της σεισμικής δραστηριότητας με βιβλιοθήκες ΕΛΛΑΚ.
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2012-01-28T00:10:00+02:00"> Σαβ 28 Ιανουαρίου 2012</time>
    </span>



        <span class="label label-default">Category</span>
        <a href="https://geographer.gr/category/gis.html">GIS</a>


<span class="label label-default">Tags</span>
	<a href="https://geographer.gr/tag/mapnik.html">mapnik</a>
        /
	<a href="https://geographer.gr/tag/ogr.html">ogr</a>
        /
	<a href="https://geographer.gr/tag/python.html">python</a>
        /
	<a href="https://geographer.gr/tag/seismoi.html">σεισμοί</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Αρκετοί χρήστες, κυρίως αρχάριοι, αναρωτιούνται γιατί να
χρησιμοποιήσει κάποιος μια γλώσσα προγραμματισμού και να συντάξει ένα
σενάριο (script), πολύπλοκων αρκετές φορές, εντολών για να παράγει ένα
χάρτη από την στιγμή που υπάρχει λογισμικό με γραφικό περιβάλλον που με
ευκολία μπορεί να οδηγήσει στο ίδιο αποτέλεσμα; Η απάντηση είναι, μεταξύ
άλλων, γιατί θέλει να αυτοματοποιήσει την διαδικασία και να αποφύγει ο
χρήστης την επανάληψη εργασιών που πολλές φορές στοιχίζει σε χρόνο και
χρήμα. Με την σύνταξη του κατάλληλου σεναρίου ο υπολογιστής αναλαμβάνει
να εκτελέσει όλη την εργασία και να την επαναλαμβάνει όποτε ο χρήστης
του ορίσει.</p>
<p><img src="https://geographer.gr/images/eqf1.png"/></p>
<p>Για να γίνει πιο κατανοητή η δύναμη της αυτοματοποιημένης
χαρτογραφίας παρατίθεται ένα παράδειγμα χαρτογράφησης των σεισμών σε
παγκόσμιο επίπεδο.</p>
<p>Τα δεδομένα για το υπόβαθρο του χάρτη προέρχονται από την ιστοσελίδα
<a href="http://www.naturalearthdata.com/">Natural Earth</a> ενώ τα
δεδομένα με τα επίκεντρα των σεισμών προέρχονται από το <a href="http://earthquake.usgs.gov/">United States Geological Survey</a>
(USGS).</p>
<p>Διαλέξαμε το <a href="http://earthquake.usgs.gov/earthquakes/catalogs/eqs7day-M2.5.tx">αρχείο</a>
που περιλαμβάνει τους σεισμούς των τελευταίων 7 ημερών μεγέθους άνω των
2,5 Richter.</p>
<p>Σκοπός του σεναρίου (script) είναι:</p>
<ul>
<li>Να κατεβάσει από το διαδίκτυο τα απαραίτητα δεδομένα σε μορφή
CSV.</li>
<li>Να μετατρέψει το αρχείο CSV σε Shapefile με την βιβλιοθήκη ogr.</li>
<li>Να παράγει τον τελικό χάρτη που θα συνδυάζει το γεωφυσικό υπόβαθρο
με τα επικεντρα των σεισμών με βοήθεια της βιβλιοθήκης Mapnik.</li>
<li>Να φορτώσει τον χάρτη σε μορφή PNG στην τρέχουσα ιστοσελίδα.</li>
<li>Να εκτελείται επαναλαμβανόμενα σε καθημερινή βάση ώστε ο χάρτης να
ανεβαίνει ενημερωμένος στην σελίδα.</li>
<li>Το σενάριο συντάχθηκε με την Python στο λειτουργικό σύστημα Ubuntu
Linux 11.04 (Natty Narwhal).</li>
</ul>
<p>Το σενάριο:</p>
<pre><code># -*- coding: utf-8 -*-
#!/usr/bin/python
 
#Εισάγουμε τις απαραίτητες βιβλιοθήκες
import os,  urllib, mapnik,  Image,  csv,  ftplib,  datetime
from osgeo import ogr
from osgeo import osr
from StringIO import StringIO
 
import PIL
from PIL import ImageFont
from PIL import Image
from PIL import ImageDraw
 
#Κατεβάζουμε τα απαραίτητα δεδομένα σε csv μορφή
print "Downloading data file..."
now = datetime.datetime.now()
url ='http://earthquake.usgs.gov/earthquakes/catalogs/eqs7day-M2.5.txt'
file = 'earthquakes.txt'
urllib.urlretrieve( url,file)
 
#Δημιουργία του shapefile
outShapeFile = 'earthquakes.shp'
drv = ogr.GetDriverByName('ESRI Shapefile')
 
if os.path.exists(str(outShapeFile)):
drv.DeleteDataSource(str(outShapeFile))
print "Deleting shapefile that already exists: " + outShapeFile
 
# Δημιουργία SpatialReference
t_srs = osr.SpatialReference()
t_srs.SetFromUserInput('WGS84')
 
ds = drv.CreateDataSource(outShapeFile)
print "Creating shapefile: " + outShapeFile
layer = ds.CreateLayer(ds.GetName(), geom_type = ogr.wkbPoint, srs = t_srs)
 
#Τα πεδία με το όνομα τους και τις ιδιότητές τους
fields=[['Src',  ogr.OFTString, 5],
['Eqid',  ogr.OFTString , 15],
['Version',  ogr.OFTInteger] ,
['Datetime',  ogr.OFTString, 255] ,
['Lat',  ogr.OFTReal],
['Lon',  ogr.OFTReal],
['Magnitude',  ogr.OFTReal],
['Depth',  ogr.OFTReal],
['NST',  ogr.OFTReal],
['Region',  ogr.OFTString, 100]
]
 
#Δημιουργία πεδίων
for field in fields:
fieldname=field[0]
fieldproperty=field[1]
print "Creating Field "  + fieldname
ofield  = ogr.FieldDefn(fieldname, fieldproperty)
if fieldproperty ==4:#Ειδικό property αν είναι string
fieldlen=field[2]
ofield.SetWidth(fieldlen)
layer.CreateField(ofield)
 
print "Creating geometry object..."
geom = ogr.Geometry(type=ogr.wkbPoint)
 
# αρχικοποίηση μιας απαραίτητης μεταβλητής
Line = ""
 
#Ανάγνωση αρχείου csv
f=open(str('earthquakes.txt'), 'r')
f.readline()
while Line.isalnum:
Line = f.readline()
if not Line: break
data = StringIO(Line)
reader = csv.reader(data, delimiter=',')
for row in reader:
geom.AddPoint(float(row[5]),float(row[4]))#Προσθήκη ενός σημείου
feat = ogr.Feature(feature_def=layer.GetLayerDefn())
print "Importing shape into feature."
feat.SetGeometry(geom)
#Προσθήκη δεδομένων στο feature
print "Importing attributes into feature."
feat.SetField('Src',row[0] )
feat.SetField('Eqid',row[1] )
feat.SetField('Version',row[2] )
feat.SetField('Datetime',row[3] )
feat.SetField('Lat',row[4] )
feat.SetField('Lon',row[5] )
feat.SetField('Magnitude',row[6] )
feat.SetField('Depth',row[7] )
feat.SetField('NST',row[8] )
feat.SetField('Region',row[9] )
layer.CreateFeature(feat)
 
#Διαγραφή objects
feat.Destroy()
ds.Destroy()
 
#Δημιουργία του χάρτη με το mapnik
 
mapfile = 'world_styles.xml' #απαραίτητο xml με τις πηγές των αρχείων και διάφορες ιδιότητές τους
map_output = 'earthquakes.png'
m = mapnik.Map(1024, 550)
mapnik.load_map(m, mapfile)
bbox = mapnik.Envelope(mapnik.Coord(-180.0, -90.0), mapnik.Coord(180.0, 90.0))
m.zoom_to_box(bbox)
mapnik.render_to_file(m, map_output,  "png") #εξαγωγή σε png
 
#Αναγραφή της ημερομηνίας ενημέρωσης του χάρτη.
font = ImageFont.truetype("/usr/share/fonts/truetype/ttf-dejavu/DejaVuSansCondensed.ttf",12)
infile = "earthquakes.png"
img=Image.open(infile)
draw = ImageDraw.Draw(img)
 
curdate= now.strftime("%d-%m-%Y %H:%M")
draw.text((10, 0),u"Τελευταία ενημέρωση:" + curdate + ", by geographer.gr",(0, 0,0),font=font)
draw = ImageDraw.Draw(img)
img.save("earthquakes.png")
 
#Δημιουργία thumbnail
print "Generate the thumbnail"
thumbfile="earthquakes_404x196_a0da98766e696ec356a29088bc2d8e16.jpg"
image = Image.open(map_output)
image = image.resize((500, 250), Image.ANTIALIAS)
image.save(thumbfile)
 
#Ανέβασμα των χαρτών με ftp στους απαραίτητους φακέλους στο geographer.gr
print "Upload data on geographer.gr"
ftp = ftplib.FTP("geographer.gr")
print ftp.login("myusername", "mypass")
print ftp.cwd('/public_html/images/stories/earthquakes')
print ftp.storbinary("STOR " + map_output, open(map_output, "rb"))
 
print ftp.cwd('/public_html/plugins/content/fboxbot/thumbs')
print ftp.storbinary("STOR " + thumbfile, open(thumbfile, "rb"))
print 'Closing FTP connection'
print ftp.close()
 
print "Job done!"
</code></pre>
<p>Όπως φαίνεται παραπάνω το mapnik χρησιμοποιεί για την δημιουργία του
χάρτη ένα αρχείο xml όπου περιέχει την προέλευση των αρχείων των
δεδομένων και διάφορες ιδιότητες τους όπως το γεωγραφικό σύστημα
αναφορά, σύμβολα και κλάσεις. Το περιεχόμενο του αρχείου δίδεται
παρακάτω:</p>
<pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;Map srs="+init=epsg:4326" bgcolor="rgb(255,255,255)"&gt;
&lt;Style name="NE2_50M_SR_W_style"&gt;
&lt;Rule&gt;
&lt;RasterSymbolizer&gt;
&lt;CssParameter name="scaling"&gt;bilinear&lt;/CssParameter&gt;
&lt;/RasterSymbolizer&gt;
&lt;/Rule&gt;
&lt;/Style&gt;
 
&lt;Style name="earthquakes_style"&gt;
&lt;Rule&gt;
&lt;Filter&gt;(([Magnitude]&amp;amp;gt;=2.5) and ([Magnitude]&amp;amp;lt;=3.5))&lt;/Filter&gt;
&lt;PointSymbolizer allow_overlap="yes" file="symbols/sym_0.png" type="png" width="7" height="7" opacity="1"&gt;&lt;/PointSymbolizer&gt;
&lt;/Rule&gt;
&lt;Rule&gt;
&lt;Filter&gt;(([Magnitude]&amp;amp;gt;3.5) and ([Magnitude]&amp;amp;lt;=4.5))&lt;/Filter&gt;
&lt;PointSymbolizer allow_overlap="yes" file="symbols/sym_1.png" type="png" width="9" height="9" opacity="1"&gt;&lt;/PointSymbolizer&gt;
&lt;/Rule&gt;
&lt;Rule&gt;
&lt;Filter&gt;(([Magnitude]&amp;amp;gt;4.5) and ([Magnitude]&amp;amp;lt;=5))&lt;/Filter&gt;
&lt;PointSymbolizer allow_overlap="yes" file="symbols/sym_2.png" type="png" width="13" height="13" opacity="1"&gt;&lt;/PointSymbolizer&gt;
&lt;/Rule&gt;
&lt;Rule&gt;
&lt;Filter&gt;(([Magnitude]&amp;amp;gt;5) and ([Magnitude]&amp;amp;lt;=5.5))&lt;/Filter&gt;
&lt;PointSymbolizer allow_overlap="yes" file="symbols/sym_3.png" type="png" width="15" height="15" opacity="1"&gt;&lt;/PointSymbolizer&gt;
&lt;/Rule&gt;
&lt;Rule&gt;
&lt;Filter&gt;(([Magnitude]&amp;amp;gt;5.5) and ([Magnitude]&amp;amp;lt;=6.2))&lt;/Filter&gt;
&lt;PointSymbolizer allow_overlap="yes" file="symbols/sym_4.png" type="png" width="21" height="21" opacity="1"&gt;&lt;/PointSymbolizer&gt;
&lt;/Rule&gt;
&lt;/Style&gt;
 
&lt;Layer name="HYP_50M_SR_W" srs="+init=epsg:4326"&gt;
&lt;StyleName&gt;NE2_50M_SR_W_style&lt;/StyleName&gt;
&lt;Datasource&gt;
&lt;Parameter name="file"&gt;NE2_50M_SR_W/NE2_50M_SR_W.tif&lt;/Parameter&gt;
&lt;Parameter name="type"&gt;gdal&lt;/Parameter&gt;
&lt;/Datasource&gt;
&lt;/Layer&gt;
&lt;Layer name="earthquakes" srs="+init=epsg:4326"&gt;
&lt;StyleName&gt;earthquakes_style&lt;/StyleName&gt;
&lt;Datasource&gt;
&lt;Parameter name="file"&gt;earthquakes.shp&lt;/Parameter&gt;
&lt;Parameter name="type"&gt;shape&lt;/Parameter&gt;
&lt;/Datasource&gt;
&lt;/Layer&gt;
 
&lt;/Map&gt;
 
&lt;!-- nik2img.py mapnik.xml out.png -d 1017 308 -e -302.42451763 -76.2454581721 301.57881763 105.848158172 --&gt;
</code></pre>
<p><img src="https://geographer.gr/images/earthquakes.png"/></p>
<p>Για την καθημερινή επαναλαμβανόμενη εκτέλεση του σεναρίου (π.χ. στις
8:50 κάθε πρωί) χρησιμοποιούμε την υπηρεσία <a href="https://en.wikipedia.org/wiki/Cron">cron</a> του linux, όπου
εισάγουμε την παρακάτω εγγραφή στο αρχείο <a href="https://web.archive.org/web/20230205213835/http://crontab.org/">crontab</a>:</p>
<pre><code>50 8 * * * cd ~/GIS/earthquakes;/usr/bin/python</code></pre>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'geographer'; // required: replace example with your forum shortname

            var disqus_config = function () {
                this.language = "en";

                        this.page.identifier = '2012-01-28-automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak';
                        this.page.url = 'https://geographer.gr/automatopoiemene-khartographese-tes-seismikes-drasteriotetas-me-bibliothekes-ellak.html';
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Social -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
  <ul class="list-group" id="social">
    <li class="list-group-item"><a href="https://www.linkedin.com/in/leonidasliakos"><i class="fa fa-linkedin-square fa-lg"></i> Linkedin</a></li>
    <li class="list-group-item"><a href="https://twitter.com/leonidasliakos"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
    <li class="list-group-item"><a href="https://github.com/kokkytos"><i class="fa fa-github-square fa-lg"></i> Github</a></li>
  </ul>
</li>
<!-- End Sidebar/Social -->

<!-- Sidebar/Categories -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categories</span></h4>
  <ul class="list-group" id="categories">
    <li class="list-group-item">
      <a href="https://geographer.gr/category/demosieuseis.html"><i class="fa fa-folder-open fa-lg"></i>Δημοσιεύσεις</a>
    </li>
    <li class="list-group-item">
      <a href="https://geographer.gr/category/diaphora.html"><i class="fa fa-folder-open fa-lg"></i>Διάφορα</a>
    </li>
    <li class="list-group-item">
      <a href="https://geographer.gr/category/gis.html"><i class="fa fa-folder-open fa-lg"></i>GIS</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Categories -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="https://gislab.gr/" target="_blank">GISlab</a>
    </li>
    <li class="list-group-item">
      <a href="https://esdac.jrc.ec.europa.eu/" target="_blank">European Soil Data Centre</a>
    </li>
    <li class="list-group-item">
      <a href="https://geographers.gr/" target="_blank">Ε.ΓΕΩ</a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2022 Leonidas Liakos
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://geographer.gr/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://geographer.gr/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://geographer.gr/theme/js/respond.min.js"></script>


    <script src="https://geographer.gr/theme/js/bodypadding.js"></script>
    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'geographer'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->


</body>
</html>